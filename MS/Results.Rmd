---
title: "RESULTS for 'same data different analysts' project, ‘Many EcoEvo Analysts’ dataset"
author: "Luke J. Eberhart-Phillips and Martin Bulla"
date: "`r Sys.time()`"
output: 
    html_document:
        code_folding: hide
bibliography: many_analysts.xml
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, fig.align = "center")
```
We found consistent treatment effects across all response variables ([Figure R](#FigR)) that were independent of the model specifications (see extended [Tables TE, WE and BE](https://www.dropbox.com/sh/fmyp12uu45qruwo/AACkHcZAZvqYL0Z0Z1ZIShF1a?dl=0) with all specified models and standardized effect sizes). In the nests where most chicks were added, which also generally corresponds to the nests with the most chicks at the day 14 (the day of chick measurement), chicks died the most (estimate [95%CI]: 0.236 [0.172 - 0.302] dead chicks per added chick), had smaller tarsus (-0.063 [-0.074 to -0.051] mm per added chick), lower body mass (-0.182 [-0.213 to -0.153] g per added chick), and were the leanest, i.e. had the lowest body mass index (-0.00037 [-0.00045 to -0.00029] per added chick; [Figure R](#FigR), Tables [M](#TableM), [T](#TableT), [W](#TableW), [B)](#TableB). The results were similar even when we controlled for nest pairs ([Figure EP](#FigEP) and Tables [TEP, WEP, BEP](https://www.dropbox.com/sh/fmyp12uu45qruwo/AACkHcZAZvqYL0Z0Z1ZIShF1a?dl=0)).

Treatment in interaction with sex did not improve the model fit (see Tables [Tc](#Tc), [Wc](#Wc), [Bc](#Bc) below) and the simplest models (model "a" in Tables [T](#Ta), [W](#Wa), [B](#Ba) performed the best of all (also exploratory) models, i.e. no other model had delta AIC smaller than 5 ([predefined a priori](https://raw.githack.com/MartinBulla/many_analysts/master/MS/Protocol.html)), and even not smaller than 2 (see extended [Tables TE, WE, BE](https://www.dropbox.com/sh/fmyp12uu45qruwo/AACkHcZAZvqYL0Z0Z1ZIShF1a?dl=0) with all specified models and standardized effect sizes).

Note that males tend to have larger tarsi and are heavier (regardless of the treatment), but their body mass index is similar to the one of females ([Figure R](#FigR)) - indicating that the body mass of each sex is proportional to their structural size and that the treatment does indeed affect only tarsus size or only body mass.

***

```{r tools, results="hide"}

reml = TRUE # models fitted with REML (TRUE) or ML (FALSE)
nsim <- 5000 # number of simulations for predictions

# load/install packages
    using<-function(...) {
        libs<-unlist(list(...))
        req<-unlist(lapply(libs,require,character.only=TRUE))
        need<-libs[req==FALSE]
        if(length(need)>0){ 
            install.packages(need)
            lapply(need,require,character.only=TRUE)
        }
    }
  packages = c('anytime','arm','data.table', 'effects', 'foreach', 'ggplot2', 'ggthemes', 'glue',  'grid', 'gridExtra', 'here', 'htmlTable', 'lattice', 'lubridate', 'magrittr', 'multcomp', 'performance','plyr','raster','stringr','zoo', 'gt', 'tidyverse', 'ggpubr')
  sapply(packages, function(x) suppressPackageStartupMessages(using(x)) )

# colors
    f_col = "#FCB42C" 
    m_col = "#535F7C"
    u_col = "#5eab2b"
  
# Customized ggplot theme
    theme_MB = theme(  
              axis.line=element_blank(),
              #axis.line = element_line(colour="grey70", size=0.25),
              axis.title = element_text(size=7, colour="grey30"),
              axis.title.y = element_text(vjust=3.5),
              axis.title.x = element_text(vjust=1),
              axis.text=element_text(size=6),#, vjust = 0.5, hjust=1),# margin=units(0.5,"mm")),
              axis.ticks.length=unit(0.5,"mm"),
              axis.ticks = element_line(colour = "grey70"),
              #axis.ticks.margin,
              
              strip.text.x = element_text(size = 6, color="grey30",  margin=margin(1,1,1,1,"mm")), #grey50
              strip.background = element_rect(fill="grey99",colour="grey70", size=0.25),
                #strip.background = element_blank(), 
                #strip.text = element_blank(),
              panel.spacing = unit(0, "mm"),
              panel.background=element_blank(),
                #panel.border=element_blank(),
              panel.border = element_rect(colour="grey70", size=0.25, fill = NA),
              panel.grid = element_blank(),
              legend.text=element_text(size=6),
              legend.title=element_text(size=7)
              )

# functions
    get_legend<-function(myggplot){
      tmp <- ggplot_gtable(ggplot_build(myggplot))
      leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
      legend <- tmp$grobs[[leg]]
      return(legend)
    }   
    
  # model output function
      m_out = function(name = "define", model = m, round_ = 3, nsim = 5000, aic = TRUE, save_sim = FALSE, N = NA){
      bsim <- sim(model, n.sim=nsim)  
        if(save_sim!=FALSE){save(bsim, file = paste0(save_sim, name,'.RData'))}
       v = apply(bsim@fixef, 2, quantile, prob=c(0.5))
       ci = apply(bsim@fixef, 2, quantile, prob=c(0.025,0.975)) 
       oi=data.frame(model = name,type='fixed',effect=rownames(coef(summary(model))),estimate=v, lwr=ci[1,], upr=ci[2,])
          rownames(oi) = NULL
          oi$estimate_r=round(oi$estimate,round_)
          oi$lwr_r=round(oi$lwr,round_)
          oi$upr_r=round(oi$upr,round_)
      oii=oi[c('model','type',"effect", "estimate_r","lwr_r",'upr_r')] 
      
       l=data.frame(summary(model)$varcor)
       l = l[is.na(l$var2),]
       l$var1 = ifelse(is.na(l$var1),"",l$var1)
       l$pred = paste(l$grp,l$var1)
    
       q050={}
       q025={}
       q975={}
       pred={}
       
       # variance of random effects
       for (ran in names(bsim@ranef)) {
         ran_type = l$var1[l$grp == ran]
         for(i in ran_type){
          q050=c(q050,quantile(apply(bsim@ranef[[ran]][,,ran_type], 1, var), prob=c(0.5)))
          q025=c(q025,quantile(apply(bsim@ranef[[ran]][,,ran_type], 1, var), prob=c(0.025)))
          q975=c(q975,quantile(apply(bsim@ranef[[ran]][,,ran_type], 1, var), prob=c(0.975)))
          pred= c(pred,paste(ran, i))
          }
         }
       # residual variance
       q050=c(q050,quantile(bsim@sigma^2, prob=c(0.5)))
       q025=c(q025,quantile(bsim@sigma^2, prob=c(0.025)))
       q975=c(q975,quantile(bsim@sigma^2, prob=c(0.975)))
       pred= c(pred,'Residual')
    
       ri=data.frame(model = name,type='random',effect=pred, estimate_r=round(100*q050/sum(q050)), lwr_r=round(100*q025/sum(q025)), upr_r=round(100*q975/sum(q975)))
         rx = ri[ri$effect == 'Residual',]
         if(rx$lwr_r>rx$upr_r){ri$lwr_r[ri$effect == 'Residual'] = rx$upr_r; ri$upr_r[ri$effect == 'Residual'] = rx$lwr_r}
         ri$estimate_r = paste0(ri$estimate_r,'%')
         ri$lwr_r = paste0(ri$lwr_r,'%')
         ri$upr_r = paste0(ri$upr_r,'%')
      
      x = rbind(oii,ri)
        x$N = ""
        x$N[1] = N
        if (aic == TRUE){   
            x$AIC = ""
            x$AIC[1]=AIC(update(model,REML = FALSE))
            x$delta = ""
            x$prob = ""
            x$ER = ""
            }
         x$R2_mar = ""
         x$R2_con = ""
         x$R2_mar [1]= r2_nakagawa(model)$R2_marginal
         x$R2_con [1]= r2_nakagawa(model)$R2_conditional
        return(x)
      } 
      
  # model assumption function
      m_ass = function(name = 'define', mo = m0, dat = d, fixed = NULL, categ = NULL, trans = NULL, spatial = TRUE, temporal = TRUE, PNG = TRUE, outdir = 'outdir'){
       l=data.frame(summary(mo)$varcor)
       l = l[is.na(l$var2),]
       if(PNG == TRUE){
        png(paste(outdir,name, ".png", sep=""), width=6,height=9,units="in",res=600)
         }else{dev.new(width=6,height=9)}
       
       n = nrow(l)-1+length(fixed)+length(categ) + 4 + if(temporal==TRUE){1}else{0} + if(spatial==TRUE){1}else{0} 
       par(mfrow=c(ceiling(n/3),3))
       
       scatter.smooth(fitted(mo),resid(mo),col='grey');abline(h=0, lty=2, col ='red')
       scatter.smooth(fitted(mo),sqrt(abs(resid(mo))), col='grey')
       qqnorm(resid(mo), main=list("Normal Q-Q Plot: residuals", cex=0.8),col='grey');qqline(resid(mo))
       #unique(l$grp[l$grp!="Residual"])
       for(i in unique(l$grp[l$grp!="Residual"])){
        #i = "mean_year"
        ll=ranef(mo)[names(ranef(mo))==i][[1]]
        if(ncol(ll)==1){
         qqnorm(ll[,1], main = paste(i,names(ll)[1]),col='grey');qqline(ll[,1], col ='red')
         }else{
          qqnorm(ll[,1], main = paste(i,names(ll)[1]),col='grey');qqline(ll[,1], col ='red')
          qqnorm(ll[,2], main = paste(i,names(ll)[2]),col='grey');qqline(ll[,2], col ='red')
         }
        }
        
       # variables
       scatter={} 
       for (i in rownames(summary(mo)$coef)) {
            #i = "lat_abs"
          j=sub("\\).*", "", sub(".*\\(", "",i)) 
          scatter[length(scatter)+1]=j
        }
        x = data.frame(scatter=unique(scatter)[2:length(unique(scatter))],
                        log_ = grepl("log",rownames(summary(mo)$coef)[2:length(unique(scatter))]), stringsAsFactors = FALSE)
        for (i in 1:length(fixed)){
            jj =fixed[i]
            variable=dat[, ..jj][[1]]
            if(trans[i]=='log'){
            scatter.smooth(resid(mo)~log(variable),xlab=paste('log(',jj,')',sep=''), col = 'grey');abline(h=0, lwd=1, lty = 2, col ='red')
            }else if(trans[i]=='abs'){
            scatter.smooth(resid(mo)~abs(variable),xlab=paste('abs(',jj,')',sep=''), col = 'grey');abline(h=0, lwd=1, lty = 2, col ='red')
            }else{
            scatter.smooth(resid(mo)~variable,xlab=jj,col = 'grey');abline(h=0, lwd=1, lty = 2, col ='red')
          }
         }
        
        if(length(categ)>0){
          for(i in categ){
             variable=dat[, ..i][[1]]
              boxplot(resid(mo)~variable, medcol='grey', whiskcol='grey', staplecol='grey', boxcol='grey', outcol='grey');abline(h=0, lty=3, lwd=1, col = 'red')
             }
        }     
              
        if(temporal == TRUE){
            acf(resid(mo), type="p", main=list("Temporal autocorrelation:\npartial series residual",cex=0.8))
            }
        if(spatial == TRUE){    
        spdata=data.frame(resid=resid(mo), x=dat$Longitude, y=dat$Latitude)
            spdata$col=ifelse(spdata$resid<0,rgb(83,95,124,100, maxColorValue = 255),ifelse(spdata$resid>0,rgb(253,184,19,100, maxColorValue = 255), 'red'))
            #cex_=c(1,2,3,3.5,4)
            cex_=c(1,1.5,2,2.5,3)
            spdata$cex=as.character(cut(abs(spdata$resid), 5, labels=cex_))
          plot(spdata$x, spdata$y,col=spdata$col, cex=as.numeric(spdata$cex), pch= 16, main=list('Spatial distribution of residuals', cex=0.8))
            legend("topleft", pch=16, legend=c('>0','<0'), ,col=c(rgb(83,95,124,100, maxColorValue = 255),rgb(253,184,19,100, maxColorValue = 255)), cex=0.8)
          plot(spdata$x[spdata$resid<0], spdata$y[spdata$resid<0],col=spdata$col[spdata$resid<0], cex=as.numeric(spdata$cex[spdata$resid<0]), pch= 16, main=list('Spatial distribution of residuals (<0)', cex=0.8))
          plot(spdata$x[spdata$resid>=0], spdata$y[spdata$resid>=0],col=spdata$col[spdata$resid>=0], cex=as.numeric(spdata$cex[spdata$resid>=0]), pch= 16, main=list('Spatial distribution of residuals (>=0)', cex=0.8))
            }
       
       mtext(paste(slot(mo,"call")[1],'(',slot(mo,"call")[2],sep=''), side = 3, line = -1, cex=0.7,outer = TRUE)
      if(PNG==TRUE){dev.off()}
      }
```
```{r prepare data, echo=FALSE, results="hide"}
# load data    
a = fread('../Data/blue_tit_data.csv') 
    # a = read.csv(here::here("Data/blue_tit_data.csv"), stringsAsFactors = FALSE)
    setnames(a, old = 'genetic_dad_ring_(WP_or_EP)', new = 'genetic_dad')

    a = a[net_rearing_manipulation != ".", .(rear_nest_breed_ID, hatch_year, rear_nest_OH, chick_sex_molec, hatch_mom_Ring, genetic_dad, day_14_weight, day_14_tarsus_length, 
        rear_nest_trt, net_rearing_manipulation, rear_Cs_at_start_of_rearing, d14_rear_nest_brood_size,  d0_hatch_nest_brood_size, rear_d0_rear_nest_brood_size,day14_measurer, rear_area)]

# 203455 nest has one chicks with different year for when the eggs began to hatch in the nest in which the chick was reared. 1 = April 1., we assign the same year as is the year for the remaining chicks
    a[rear_nest_breed_ID == '203455', hatch_year := 2003]

# define NAs and column and variable definitions
    a[hatch_mom_Ring %in% ".", hatch_mom_Ring := NA]
    a[genetic_dad %in% ".", genetic_dad := NA]
    a[, rear_Cs_at_start_of_rearing := as.numeric(rear_Cs_at_start_of_rearing)]
    a[, net_rearing_manipulation := as.numeric(net_rearing_manipulation)]
    a[, d14_rear_nest_brood_size := as.numeric(d14_rear_nest_brood_size)]
    a[, d0_hatch_nest_brood_size := as.numeric(d0_hatch_nest_brood_size)]
    a[, rear_d0_rear_nest_brood_size := as.numeric(rear_d0_rear_nest_brood_size)]
    a[chick_sex_molec %in% ".", chick_sex_molec := "u"]
    a[chick_sex_molec %in% "1", chick_sex_molec := "f"]
    a[chick_sex_molec %in% "2", chick_sex_molec := "m"]
    a[rear_nest_trt %in% "5", treatment := "increased"]
    a[rear_nest_trt %in% "6", treatment := "reduced"]
    a[rear_nest_trt %in% "7", treatment := "constant"]

# compute  variables
    a[, change_chick_n := rear_Cs_at_start_of_rearing-d14_rear_nest_brood_size]
    a[, rear_nest_OH_l :=  rear_nest_OH - min(rear_nest_OH), by = hatch_year] # day when first nest hatch in a given year is zero day of the season
    a[, net_rearing_manipulation_factor := as.factor(net_rearing_manipulation)]
    a[, prop_change_in_brood_size := net_rearing_manipulation/d0_hatch_nest_brood_size]
    # sex ration at day 14
        a[chick_sex_molec == 'm', sex := 1]
        a[chick_sex_molec == 'f', sex := 0]
        a[chick_sex_molec == 'u', sex := 0.5]
        a[, brood_sex_ratio := sum(sex)/length(sex), by = rear_nest_breed_ID]
    # body mass index
        a[, body_mass_index := day_14_weight/day_14_tarsus_length^2]
# dataset for chick mortality
    mmo = a[complete.cases(a),.(change_chick_n, net_rearing_manipulation, d14_rear_nest_brood_size, brood_sex_ratio, day14_measurer, rear_area, rear_nest_OH_l, hatch_year,rear_nest_breed_ID)]
    mou = unique(mmo)
    nrow(mou)
    length(unique(mmo$rear_nest_breed_ID))
    mou[, net_rearing_manipulation_factor := as.factor(net_rearing_manipulation)]
    
    reml = TRUE
    
# dataset for paired analyses
    p = fread('../Data/blue_tit_nest_pairs_IDs.csv') 
    p = merge(a,p[,.(rear_nest_breed_ID, pair_ID)], all.x = TRUE)
    p = p[!is.na(pair_ID)]

# dataset for paired plots
    BT_data <- read.csv(file = "../Data/blue_tit_data.csv", stringsAsFactors = FALSE)
   BT_data_tidy <-
  BT_data %>% 
  # select variables of interest
  dplyr::select(chick_ring_number, hatch_year, hatch_nest_breed_ID, rear_nest_breed_ID, rear_area, hatch_mom_Ring, 
         genetic_dad_ring_.WP_or_EP., hatch_nest_OH, rear_nest_OH, d0_hatch_nest_brood_size, rear_d0_rear_nest_brood_size,
         rear_nest_trt, net_rearing_manipulation, rear_Cs_at_start_of_rearing, d14_rear_nest_brood_size, 
         day_14_tarsus_length, day_14_weight, day14_measurer, chick_sex_molec, number_chicks_fledged_from_rear_nest) %>%
  # rename the genetic dad vaiable
  dplyr::rename(genetic_dad_ring = genetic_dad_ring_.WP_or_EP., 
         d0_rear_nest_brood_size = rear_d0_rear_nest_brood_size) %>% 
  # replace all "." with NA in factor variables
  dplyr::mutate(chick_sex_molec = as.factor(ifelse(chick_sex_molec == ".", NA, 
                                ifelse(chick_sex_molec == "1", "Female", "Male"))),
         chick_BMI = day_14_weight/(day_14_tarsus_length^2)) %>%
  dplyr::mutate_at(c("hatch_year", "hatch_nest_breed_ID", "rear_nest_breed_ID", 
              "day14_measurer", "rear_nest_trt", "hatch_mom_Ring", 
              "genetic_dad_ring", "chick_ring_number", "rear_area"), 
            as.factor) %>% 
  dplyr::mutate_if(is.factor, list(~dplyr::na_if(., "."))) %>% 
  dplyr::mutate_at(c("net_rearing_manipulation", "rear_Cs_at_start_of_rearing", "d0_hatch_nest_brood_size", 
              "d0_rear_nest_brood_size", "number_chicks_fledged_from_rear_nest"), 
            as.numeric) %>% 
  # re-name the treatment groups
  dplyr::mutate(rear_nest_trt = 
           as.factor(ifelse(rear_nest_trt == "5", "increase", 
                        ifelse(rear_nest_trt == "6", "decrease", "control")))) %>% 
  dplyr::mutate(prop_change_in_brood_size = net_rearing_manipulation/d0_hatch_nest_brood_size,
                change_chick_n = rear_Cs_at_start_of_rearing - d14_rear_nest_brood_size)

BT_nest_pairs <- 
  BT_data_tidy %>% 
  dplyr::group_by(chick_ring_number) %>% 
  dplyr::mutate_at(c("hatch_nest_breed_ID", "rear_nest_breed_ID"), as.character) %>% 
  dplyr::mutate_at(c("hatch_nest_breed_ID", "rear_nest_breed_ID"), as.numeric) %>% 
  dplyr::summarise(pair_ID_min = min(hatch_nest_breed_ID, rear_nest_breed_ID),
            pair_ID_max = max(hatch_nest_breed_ID, rear_nest_breed_ID)) %>% 
  dplyr::left_join(BT_data_tidy, ., by = "chick_ring_number") %>% 
  dplyr::select(hatch_nest_breed_ID, rear_nest_breed_ID, d0_hatch_nest_brood_size,
         d0_rear_nest_brood_size, rear_nest_trt, net_rearing_manipulation,
         rear_Cs_at_start_of_rearing, pair_ID_min, pair_ID_max) %>%
  dplyr::distinct() %>% 
  dplyr::filter(pair_ID_min != pair_ID_max) %>% 
  dplyr::mutate(pair_ID = paste(pair_ID_min, pair_ID_max, sep = "_")) %>% 
  dplyr::select(hatch_nest_breed_ID, pair_ID)

BT_data_tidy <- 
  BT_data_tidy %>% 
  dplyr::left_join(., BT_nest_pairs, by = "hatch_nest_breed_ID")

morphometric_summaries <- 
  BT_data_tidy %>% 
  dplyr::mutate(day_14_BMI = day_14_weight/(day_14_tarsus_length^2)) %>% 
  dplyr::group_by(pair_ID, rear_nest_trt) %>% 
  dplyr::summarise(mean_tarsus = mean(day_14_tarsus_length, na.rm = TRUE),
            median_tarsus = median(day_14_tarsus_length, na.rm = TRUE),
            sd_tarsus = sd(day_14_tarsus_length, na.rm = TRUE),
            se_tarsus = sd(day_14_tarsus_length, na.rm = TRUE)/sqrt(n()),
            mean_mass = mean(day_14_weight, na.rm = TRUE),
            median_mass = median(day_14_weight, na.rm = TRUE),
            sd_mass = sd(day_14_weight, na.rm = TRUE),
            se_mass = sd(day_14_weight, na.rm = TRUE)/sqrt(n()),
            mean_BMI = mean(day_14_BMI, na.rm = TRUE),
            median_BMI = median(day_14_BMI, na.rm = TRUE),
            sd_BMI = sd(day_14_BMI, na.rm = TRUE),
            se_BMI = sd(day_14_BMI, na.rm = TRUE)/sqrt(n()),
            change_chick_n = change_chick_n) %>% 
  dplyr::distinct() %>% 
  dplyr::filter(rear_nest_trt != "control") %>% 
  tidyr::pivot_wider(names_from = rear_nest_trt, 
                     values_fn = list(mean_tarsus = mean,
                                      median_tarsus = mean,
                                      sd_tarsus = mean, 
                                      se_tarsus = mean, 
                                      mean_mass = mean, 
                                      median_mass = mean, 
                                      sd_mass = mean, 
                                      se_mass = mean, 
                                      mean_BMI = mean, 
                                      median_BMI = mean, 
                                      sd_BMI = mean, 
                                      se_BMI = mean,
                                      change_chick_n = mean),
              values_from = c(mean_tarsus, median_tarsus, sd_tarsus, se_tarsus, 
                              mean_mass, median_mass, sd_mass, se_mass, 
                              mean_BMI, median_BMI, sd_BMI, se_BMI,
                              change_chick_n)) %>% 
  na.omit 
```
```{r Fig R, echo=FALSE, fig.width = 7*0.393701, fig.height = 12*0.393701}
# limit data to available cases
      dtg = a[complete.cases(a),.(day_14_tarsus_length, day_14_weight, body_mass_index,  net_rearing_manipulation, net_rearing_manipulation_factor, d14_rear_nest_brood_size, chick_sex_molec, brood_sex_ratio, day14_measurer, rear_area, rear_nest_OH_l, hatch_year,rear_nest_breed_ID, hatch_mom_Ring, genetic_dad)]
# predictions 
        # mortality
            m = lmer(change_chick_n ~ net_rearing_manipulation  +       
                      brood_sex_ratio +     
                      (1|day14_measurer) + 
                      (1|rear_area) +      
                      (1|rear_nest_OH_l) + (1|hatch_year),       
                      data = mou, REML = reml        
                 )   
            bsim <- sim(m, n.sim=nsim)  
                
            # coefficients
                v = apply(bsim@fixef, 2, quantile, prob=c(0.5))
                ci = apply(bsim@fixef, 2, quantile, prob=c(0.025, 0.975))

            # values to predict for
                newD=data.frame(net_rearing_manipulation = seq(min(mou$net_rearing_manipulation), max(mou$net_rearing_manipulation), length.out = 300), chick_sex_molec = c('m','f','u'), brood_sex_ratio = mean(mou$brood_sex_ratio))

            # exactly the model which was used has to be specified here 
                X <- model.matrix(~ net_rearing_manipulation +  
                        brood_sex_ratio ,data=newD)   
                            
            # calculate predicted values and creditability intervals
                newD$pred <-(X%*%v) 
                predmatrix <- matrix(nrow=nrow(newD), ncol=nsim)
                for(i in 1:nsim) predmatrix[,i] <- (X%*%bsim@fixef[i,])
                    predmatrix[predmatrix < 0] <- 0
                    newD$lwr <- apply(predmatrix, 1, quantile, prob=0.025)
                    newD$upr <- apply(predmatrix, 1, quantile, prob=0.975)
                    newD$pred <- apply(predmatrix, 1, quantile, prob=0.5)
            pm=newD   
        
        # tarsus 
            m=  lmer(day_14_tarsus_length ~ 
                    net_rearing_manipulation +  
                    chick_sex_molec + 
                    brood_sex_ratio +
                    (1|day14_measurer) + (1|rear_area) + 
                    (1|rear_nest_OH_l) + (1|hatch_year)  +
                    (1|rear_nest_breed_ID) +
                    (1|hatch_mom_Ring) + (1|genetic_dad),
                    data = dtg, REML = reml
                    )

            bsim <- sim(m, n.sim=nsim)  
                
            # coefficients
                v = apply(bsim@fixef, 2, quantile, prob=c(0.5))
                ci = apply(bsim@fixef, 2, quantile, prob=c(0.025, 0.975))

            # values to predict for
                newD=data.frame(net_rearing_manipulation = seq(min(dtg$net_rearing_manipulation), max(dtg$net_rearing_manipulation), length.out = 300), chick_sex_molec = c('m','f','u'), brood_sex_ratio = mean(dtg$brood_sex_ratio))

            # exactly the model which was used has to be specified here 
                X <- model.matrix(~ net_rearing_manipulation +  
                        chick_sex_molec + 
                        brood_sex_ratio ,data=newD)   
                            
            # calculate predicted values and creditability intervals
                newD$pred <-(X%*%v) 
                predmatrix <- matrix(nrow=nrow(newD), ncol=nsim)
                for(i in 1:nsim) predmatrix[,i] <- (X%*%bsim@fixef[i,])
                    predmatrix[predmatrix < 0] <- 0
                    newD$lwr <- apply(predmatrix, 1, quantile, prob=0.025)
                    newD$upr <- apply(predmatrix, 1, quantile, prob=0.975)
                    newD$pred <- apply(predmatrix, 1, quantile, prob=0.5)
            pt=newD 
            pt$chick_sex_molec = ifelse(pt$chick_sex_molec == 'u', "unknown", ifelse(pt$chick_sex_molec =='f', 'female', 'male'))   
        # weight
            m=  lmer(day_14_weight ~ 
                    net_rearing_manipulation +  
                    chick_sex_molec + 
                    brood_sex_ratio +
                    (1|day14_measurer) + (1|rear_area) + 
                    (1|rear_nest_OH_l) + (1|hatch_year)  +
                    (1|rear_nest_breed_ID) +
                    (1|hatch_mom_Ring) + (1|genetic_dad),
                    data = dtg, REML = reml
                    )

            bsim <- sim(m, n.sim=nsim)  
                
            # coefficients
                v = apply(bsim@fixef, 2, quantile, prob=c(0.5))
                ci = apply(bsim@fixef, 2, quantile, prob=c(0.025, 0.975))

            # values to predict for
                newD=data.frame(net_rearing_manipulation = seq(min(dtg$net_rearing_manipulation), max(dtg$net_rearing_manipulation), length.out = 300), chick_sex_molec = c('m','f','u'), brood_sex_ratio = mean(dtg$brood_sex_ratio))

            # exactly the model which was used has to be specified here 
                X <- model.matrix(~ net_rearing_manipulation +  
                        chick_sex_molec + 
                        brood_sex_ratio ,data=newD)   
                            
            # calculate predicted values and creditability intervals
                newD$pred <-(X%*%v) 
                predmatrix <- matrix(nrow=nrow(newD), ncol=nsim)
                for(i in 1:nsim) predmatrix[,i] <- (X%*%bsim@fixef[i,])
                    predmatrix[predmatrix < 0] <- 0
                    newD$lwr <- apply(predmatrix, 1, quantile, prob=0.025)
                    newD$upr <- apply(predmatrix, 1, quantile, prob=0.975)
                    newD$pred <- apply(predmatrix, 1, quantile, prob=0.5)
            pw=newD   
            pw$chick_sex_molec = ifelse(pw$chick_sex_molec == 'u', "unknown", ifelse(pw$chick_sex_molec =='f', 'female', 'male'))   
        # BMI
            m=  lmer(body_mass_index ~ 
                    net_rearing_manipulation +  
                    chick_sex_molec + 
                    brood_sex_ratio +
                    (1|day14_measurer) + (1|rear_area) + 
                    (1|rear_nest_OH_l) + (1|hatch_year)  +
                    (1|rear_nest_breed_ID) +
                    (1|hatch_mom_Ring) + (1|genetic_dad),
                    data = dtg, REML = reml
                    )

            nsim <- 5000
            bsim <- sim(m, n.sim=nsim)  
                
            # coefficients
                v = apply(bsim@fixef, 2, quantile, prob=c(0.5))
                ci = apply(bsim@fixef, 2, quantile, prob=c(0.025, 0.975))

            # values to predict for
                newD=data.frame(net_rearing_manipulation = seq(min(dtg$net_rearing_manipulation), max(dtg$net_rearing_manipulation), length.out = 300), chick_sex_molec = c('m','f','u'), brood_sex_ratio = mean(dtg$brood_sex_ratio))

            # exactly the model which was used has to be specified here 
                X <- model.matrix(~ net_rearing_manipulation +  
                        chick_sex_molec + 
                        brood_sex_ratio ,data=newD)   
                            
            # calculate predicted values and creditability intervals
                newD$pred <-(X%*%v) 
                predmatrix <- matrix(nrow=nrow(newD), ncol=nsim)
                for(i in 1:nsim) predmatrix[,i] <- (X%*%bsim@fixef[i,])
                    predmatrix[predmatrix < 0] <- 0
                    newD$lwr <- apply(predmatrix, 1, quantile, prob=0.025)
                    newD$upr <- apply(predmatrix, 1, quantile, prob=0.975)
                    newD$pred <- apply(predmatrix, 1, quantile, prob=0.5)
            pb=newD    
            pb$chick_sex_molec = ifelse(pb$chick_sex_molec == 'u', "unknown", ifelse(pb$chick_sex_molec =='f', 'female', 'male'))   
    # prepare plots       
        ggm = ggplot(pm, aes(x = net_rearing_manipulation, y = pred))  +
            geom_ribbon(aes(ymin=lwr, ymax=upr, x=net_rearing_manipulation), alpha = 0.1, show.legend = NA)+ 
            geom_line() +
            labs(x = 'Number of taken/added chicks', y = 'Dead chicks', tag = '(a)')  +
            theme_bw() + theme_MB + 
            theme(  legend.position="none",
                    axis.title.x=element_blank(),
                    axis.text.x=element_blank(),
                    axis.ticks.x=element_blank(),
                     plot.tag.position = c(0.95, 0.95),
                    plot.tag = element_text(size = 7.5))
        
        ggt = ggplot(pt, aes(x = net_rearing_manipulation, y = pred))  +
            geom_ribbon(aes(ymin=lwr, ymax=upr, x=net_rearing_manipulation, fill = chick_sex_molec), alpha = 0.2, show.legend = NA)+ 
            geom_line(aes(col =chick_sex_molec)) +
            labs(x = 'Number of taken/added chicks', y = 'Tarsus length [mm]', tag = '(b)', fill = 'Chick sex', col = 'Chick sex')+
            scale_fill_manual(labels = c("female", "male", 'unknown'), values = c(f_col, m_col, u_col))+
            scale_color_manual(labels = c("female", "male", 'unknown'), values = c(f_col, m_col, u_col))+
            theme_bw() + theme_MB + 
            theme(  axis.title.x=element_blank(),
                    axis.text.x=element_blank(),
                    axis.ticks.x=element_blank(),
                    plot.tag.position = c(0.95, 0.95),
                    plot.tag = element_text(size = 7.5))
        legend = get_legend(ggt)
        ggt = ggt + theme(legend.position="none")   

        ggw = ggplot(pw, aes(x = net_rearing_manipulation, y = pred))  +
            geom_ribbon(aes(ymin=lwr, ymax=upr, x=net_rearing_manipulation, fill = chick_sex_molec), alpha = 0.2, show.legend = NA)+ 
            geom_line(aes(col =chick_sex_molec)) +
            labs(x = 'Number of taken/added chicks', y = 'Weight [g]', tag = '(c)')  +
            scale_fill_manual(labels = c("female", "male", 'unknown'), values = c(f_col, m_col, u_col))+
            scale_color_manual(labels = c("female", "male", 'unknown'), values = c(f_col, m_col, u_col))+
            theme_bw() + theme_MB + 
            theme(  legend.position="none",
                    axis.title.x=element_blank(),
                    axis.text.x=element_blank(),
                    axis.ticks.x=element_blank(),
                     plot.tag.position = c(0.95, 0.95),
                    plot.tag = element_text(size = 7.5))
        
        ggb = ggplot(pb, aes(x = net_rearing_manipulation, y = pred))  +
            geom_ribbon(aes(ymin=lwr, ymax=upr, x=net_rearing_manipulation, fill = chick_sex_molec), alpha = 0.2, show.legend = NA)+ 
            geom_line(aes(col =chick_sex_molec)) + 
            labs(x = 'Number of taken/added chicks', y = 'Body mass index', tag = '(d)') +
            scale_fill_manual(labels = c("female", "male", 'unknown'), values = c(f_col, m_col, u_col))+
            scale_color_manual(labels = c("female", "male", 'unknown'), values = c(f_col, m_col, u_col))+
            theme_bw() + theme_MB + 
            theme(  legend.position="none",
                    #axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)
                    plot.tag.position = c(0.95, 0.95),
                    plot.tag = element_text(size = 7.5))
    # Figure R - COMBINED MTWB   
        g0 <- ggplotGrob(ggm)
        g1 <- ggplotGrob(ggt)
        g2 <- ggplotGrob(ggw)
        g3 <- ggplotGrob(ggb)
        
        grid.arrange(rbind(g0,g1,g2,g3, size = "first"), legend, ncol = 2, padding = 0, widths =c(3.7, 1.25)) 
```

#### Figure R | Chick mortality and size according to net change in brood size {#FigR}
Change in chick number between day 0 and day 14 of the experiment (a), tarsus length (b), body mass (c) and body mass index (d) at day 14 of the experiment given the experimental change in chick numbers within given nest (note that 0 indicates no change, i.e. control nests). Lines with shaded polygons indicate model predictions with 95%CI based on the joint posterior distribution of 5,000 simulated values generated by the ‘sim’ function in R (Gelman and Su 2018) from the model outputs (Tables [M](#TableM), [Ta](#Ta), [Wa](#Wa), [Ba](#Ba)), while keeping the other predictors constant. Color in b-d indicates molecular sex of the chick (yellow = female, blue = male and green = unknown).

```{r prepare for Table M, echo=FALSE, results="hide", cache=TRUE}
m = lmer(change_chick_n ~ net_rearing_manipulation  +       
                      brood_sex_ratio +     
                      (1|day14_measurer) + 
                      (1|rear_area) +      
                      (1|rear_nest_OH_l) + (1|hatch_year),       
                      data = mou, REML = reml        
                 )   
o_m = m_out(name = "mortality", model = m, round_ = 3, nsim = 5000, aic = TRUE, N = nrow(mou))
o_m_source_note = paste("N = ", o_m$N[1], "nests, AIC = ", round(as.numeric(o_m$AIC[1], 4), 2), ", Marginal R-squared = ", round(as.numeric(o_m$R2_mar[1], 4), 2), ", Conditional R-squared = ", round(as.numeric(o_m$R2_con[1], 4), 2))
```
***
#### Table M | Effect sizes for chick mortality (*Model M*) {#TableM}
```{r, echo=FALSE}
o_m %>% 
  mutate(CI_String = ifelse(!is.na(lwr_r),
                     paste0("[", 
                     lwr_r, ", ", 
                     upr_r, "]"),
                     NA)) %>% 
  dplyr::select(type, effect, estimate_r, CI_String) %>% 
  gt(groupname_col = "type") %>% 
  cols_label(effect = "Effect type",
             estimate_r = "Parameter estimate",
             CI_String = "95% credible interval") %>% 
  cols_align(align = "left",
             columns = vars(effect)) %>% 
  tab_options(row_group.font.weight = "bold",
              row_group.background.color = "grey",
              table.font.size = 12,
              data_row.padding = 3,
              row_group.padding = 4,
              summary_row.padding = 2,
              column_labels.font.size = 14,
              row_group.font.size = 12,
              table.width = pct(80)) #%>% 
  # tab_source_note(source_note = o_m_source_note)
```

***

```{r, echo=FALSE, results="hide"}
dtg = a[complete.cases(a),.(day_14_tarsus_length, net_rearing_manipulation, net_rearing_manipulation_factor, d14_rear_nest_brood_size, chick_sex_molec, brood_sex_ratio, day14_measurer, rear_area, rear_nest_OH_l, hatch_year,rear_nest_breed_ID, hatch_mom_Ring, genetic_dad)]
cor(dtg$d14_rear_nest_brood_size, dtg$net_rearing_manipulation)
```

```{r, results="hide", cache=TRUE, echo=FALSE}
mt0g =  lmer(day_14_tarsus_length ~ 
    net_rearing_manipulation +  
    chick_sex_molec + 
    brood_sex_ratio +
    (1|day14_measurer) + (1|rear_area) + 
    (1|rear_nest_OH_l) + (1|hatch_year)  +
    (1|rear_nest_breed_ID) +
    (1|hatch_mom_Ring) + (1|genetic_dad),
    data = dtg, REML = reml
    )
```

```{r, echo=FALSE, cache=TRUE, eval=FALSE}
plot(allEffects(mt0g))
```

```{r, echo=FALSE, results="hide", cache=TRUE}
o_mt0g = m_out(name = "a - net chick", model = mt0g, round_ = 3, nsim = 5000, aic = TRUE, N = 2550)
```

#### Table T | Effect sizes for chick tarsus models {#TableT}
##### a {#Ta}
```{r, echo=FALSE}
o_mt0g_source_note = paste("N = ", o_mt0g$N[1], "nests, AIC = ", round(as.numeric(o_mt0g$AIC[1], 4), 2), ", Marginal R-squared = ", round(as.numeric(o_mt0g$R2_mar[1], 4), 2), ", Conditional R-squared = ", round(as.numeric(o_mt0g$R2_con[1], 4), 2))

o_mt0g %>% 
  mutate(CI_String = ifelse(!is.na(lwr_r),
                     paste0("[", 
                     lwr_r, ", ", 
                     upr_r, "]"),
                     NA)) %>% 
  dplyr::select(type, effect, estimate_r, CI_String) %>% 
  gt(groupname_col = "type") %>% 
  cols_label(effect = "Effect type",
             estimate_r = "Parameter estimate",
             CI_String = "95% credible interval") %>% 
  cols_align(align = "left",
             columns = vars(effect)) %>% 
  tab_options(row_group.font.weight = "bold",
              row_group.background.color = "grey",
              table.font.size = 12,
              data_row.padding = 3,
              row_group.padding = 4,
              summary_row.padding = 2,
              column_labels.font.size = 14,
              row_group.font.size = 12,
              table.width = pct(80)) #%>% 
  # tab_source_note(source_note = o_mt0g_source_note)
```


```{r, results="hide", cache=TRUE, echo=FALSE}
mt14g =  lmer(day_14_tarsus_length ~ 
    d14_rear_nest_brood_size +  
    chick_sex_molec + 
    brood_sex_ratio +
    (1|day14_measurer) + (1|rear_area) + 
    (1|rear_nest_OH_l) + (1|hatch_year)  +
    (1|rear_nest_breed_ID) + (1|hatch_mom_Ring) + (1|genetic_dad),
    data = dtg, REML = reml
    )
```

```{r, echo=FALSE, eval=FALSE}
summary(mt14g) 
summary(glht(mt14g))
```

```{r, echo=FALSE, eval=FALSE}
plot(allEffects(mt14g))
```
```{r, echo=FALSE, results="hide", cache=TRUE}
o_mt14g  = m_out(name = "b - day 14 chick #", model = mt14g, round_ = 3, nsim = 5000, aic = TRUE, N = 2550)
```

##### b {#Tb}
```{r, echo=FALSE}
o_mt14g_source_note = paste("N = ", o_mt14g$N[1], "nests, AIC = ", round(as.numeric(o_mt14g$AIC[1], 4), 2), ", Marginal R-squared = ", round(as.numeric(o_mt14g$R2_mar[1], 4), 2), ", Conditional R-squared = ", round(as.numeric(o_mt14g$R2_con[1], 4), 2))

o_mt14g %>% 
  mutate(CI_String = ifelse(!is.na(lwr_r),
                     paste0("[", 
                     lwr_r, ", ", 
                     upr_r, "]"),
                     NA)) %>% 
  dplyr::select(type, effect, estimate_r, CI_String) %>% 
  gt(groupname_col = "type") %>% 
  cols_label(effect = "Effect type",
             estimate_r = "Parameter estimate",
             CI_String = "95% credible interval") %>% 
  cols_align(align = "left",
             columns = vars(effect)) %>% 
  tab_options(row_group.font.weight = "bold",
              row_group.background.color = "grey",
              table.font.size = 12,
              data_row.padding = 3,
              row_group.padding = 4,
              summary_row.padding = 2,
              column_labels.font.size = 14,
              column_labels.hidden = TRUE,
              row_group.font.size = 12,
              table.width = pct(80)) #%>% 
  # tab_source_note(source_note = o_mt14g_source_note)
```

```{r, results="hide", cache=TRUE, echo=FALSE}
mt0gs =  lmer(day_14_tarsus_length ~ 
    net_rearing_manipulation * chick_sex_molec + 
    brood_sex_ratio +
    (1|day14_measurer) + (1|rear_area) + 
    (1|rear_nest_OH_l) + (1|hatch_year)  +
    (1|rear_nest_breed_ID)+
    (1|hatch_mom_Ring) + (1|genetic_dad),
    data = dtg, REML = reml
    )
```

```{r, echo=FALSE, eval=FALSE}
plot(allEffects(mt0gs))
```
```{r, echo=FALSE, results="hide", cache=TRUE}
o_mt0gs = m_out(name = "c - (a) with sex interaction", model = mt0gs, round_ = 3, nsim = 5000, aic = TRUE, N = 2550)
```

##### c {#Tc}
```{r, echo=FALSE}
o_mt0gs_source_note = paste("N = ", o_mt0gs$N[1], "nests, AIC = ", round(as.numeric(o_mt0gs$AIC[1], 4), 2), ", Marginal R-squared = ", round(as.numeric(o_mt0gs$R2_mar[1], 4), 2), ", Conditional R-squared = ", round(as.numeric(o_mt0gs$R2_con[1], 4), 2))

o_mt0gs %>% 
  mutate(CI_String = ifelse(!is.na(lwr_r),
                     paste0("[", 
                     lwr_r, ", ", 
                     upr_r, "]"),
                     NA)) %>% 
  dplyr::select(type, effect, estimate_r, CI_String) %>% 
  gt(groupname_col = "type") %>% 
  cols_label(effect = "Effect type",
             estimate_r = "Parameter estimate",
             CI_String = "95% credible interval") %>% 
  cols_align(align = "left",
             columns = vars(effect)) %>% 
  tab_options(row_group.font.weight = "bold",
              row_group.background.color = "grey",
              table.font.size = 12,
              data_row.padding = 3,
              row_group.padding = 4,
              summary_row.padding = 2,
              column_labels.font.size = 14,
              column_labels.hidden = TRUE,
              row_group.font.size = 12,
              table.width = pct(80)) #%>% 
  # tab_source_note(source_note = o_mt0gs_source_note)
```

```{r, eval=FALSE, echo=FALSE}
            sname = 'Table_T'

            aic = data.table(rbind(o_mt0g,o_mt14g,o_mt0gs))[AIC!=""]
            aic[, AIC := as.numeric(AIC)]
            aic[, deltaAIC := AIC-min(AIC)]
            aic[, prob := round(exp(-0.5*deltaAIC)/sum(exp(-0.5*deltaAIC)),2)]
            aic[, ER := round(max(prob)/prob, 2)]
            aic[order(deltaAIC)]
            o = rbind(o_mt0g,o_mt14g,o_mt0gs)
            o$deltaAIC[o$AIC!=""] = aic$deltaAIC[match(o$model[o$AIC!=""], aic$model)]
            o$prob[o$AIC!=""] = aic$prob[match(o$model[o$AIC!=""], aic$model)]
            o$ER[o$AIC!=""] = aic$ER[match(o$model[o$AIC!=""], aic$model)]
            write.xlsx(o, paste0("Output/",sname,'.xlsx'), sheetName='Estimates&AIC')
            #write_xlsx(rbind(o_mt0g,o_mt14g,o_mt0g), paste0("Outputs/",sname,'.xlsx'), sheetName='AICcompar', append = TRUE)

            m_ass(name = 'Table Ta - tarsus-net+sex + day14_brood_sex_ratio', mo = mt0g, dat = dtg, fixed = c('net_rearing_manipulation', 'brood_sex_ratio'),categ = 'chick_sex_molec', trans = c('none','none','none'), spatial = FALSE, temporal = TRUE, PNG = TRUE, outdir = "Output/Model_ass/")
            
            m_ass(name = 'Table Tb - tarsus-d14+sex + day14_brood_sex_ratio', mo = mt14g, dat = dtg, fixed = c('d14_rear_nest_brood_size', 'brood_sex_ratio'),categ = 'chick_sex_molec', trans = c('none','none','none'), spatial = FALSE, temporal = TRUE, PNG = TRUE, outdir = "Output/Model_ass/")

            m_ass(name = 'Table Tc - tarsus-netxsex + day14_brood_sex_ratio', mo = mt0gs, dat = dtg, fixed = c('net_rearing_manipulation', 'brood_sex_ratio'),categ = 'chick_sex_molec', trans = c('none','none','none'), spatial = FALSE, temporal = TRUE, PNG = TRUE, outdir = "Output/Model_ass/")
```

***

```{r, echo=FALSE}
dwg = a[complete.cases(a),.(day_14_weight, net_rearing_manipulation, net_rearing_manipulation_factor, d14_rear_nest_brood_size, chick_sex_molec, brood_sex_ratio, day14_measurer, rear_area, rear_nest_OH_l, hatch_year,rear_nest_breed_ID, hatch_mom_Ring, genetic_dad)]
            
```

```{r, results="hide", cache=TRUE, echo=FALSE}
mw0g =  lmer(day_14_weight ~ 
  net_rearing_manipulation +  
  chick_sex_molec + 
  brood_sex_ratio +
  (1|day14_measurer) + (1|rear_area) + 
  (1|rear_nest_OH_l) + (1|hatch_year)  +
  (1|rear_nest_breed_ID) +
  (1|hatch_mom_Ring) + (1|genetic_dad),
  data = dwg, REML = reml
  )
```

```{r, echo=FALSE, eval=FALSE}
summary(mw0g) 
summary(glht(mw0g))
```

```{r, echo=FALSE, eval=FALSE}
plot(allEffects(mw0g))
```


```{r, echo=FALSE, results="hide", cache=TRUE}
o_mw0g = m_out(name = "a - net chick", model = mw0g, round_ = 3, nsim = 5000, aic = TRUE, N = 2550)
```

#### Table W | Effect sizes for chick weight models {#TableW}
##### a {#Wa}
```{r, echo=FALSE}
o_mw0g_source_note = paste("N = ", o_mw0g$N[1], "nests, AIC = ", round(as.numeric(o_mw0g$AIC[1], 4), 2), ", Marginal R-squared = ", round(as.numeric(o_mw0g$R2_mar[1], 4), 2), ", Conditional R-squared = ", round(as.numeric(o_mw0g$R2_con[1], 4), 2))

o_mw0g %>% 
  mutate(CI_String = ifelse(!is.na(lwr_r),
                     paste0("[", 
                     lwr_r, ", ", 
                     upr_r, "]"),
                     NA)) %>% 
  dplyr::select(type, effect, estimate_r, CI_String) %>% 
  gt(groupname_col = "type") %>% 
  cols_label(effect = "Effect type",
             estimate_r = "Parameter estimate",
             CI_String = "95% credible interval") %>% 
  cols_align(align = "left",
             columns = vars(effect)) %>% 
  tab_options(row_group.font.weight = "bold",
              row_group.background.color = "grey",
              table.font.size = 12,
              data_row.padding = 3,
              row_group.padding = 4,
              summary_row.padding = 2,
              column_labels.font.size = 14,
              row_group.font.size = 12,
              table.width = pct(80)) #%>% 
  # tab_source_note(source_note = o_mw0g_source_note)
```


```{r, results="hide", cache=TRUE, echo=FALSE}
mw14g =  lmer(day_14_weight ~ 
  d14_rear_nest_brood_size +  
  chick_sex_molec + 
  brood_sex_ratio +
  (1|day14_measurer) + (1|rear_area) + 
  (1|rear_nest_OH_l) + (1|hatch_year)  +
  (1|rear_nest_breed_ID) + (1|hatch_mom_Ring) + (1|genetic_dad),
  data = dwg, REML = reml
  )
```

```{r, echo=FALSE, eval=FALSE}
summary(mw14g) 
summary(glht(mw14g))
```

```{r, echo=FALSE, eval=FALSE}
plot(allEffects(mw14g))
```
```{r, echo=FALSE, results="hide", cache=TRUE}
o_mw14g  = m_out(name = "b - day 14 chick #", model = mw14g, round_ = 3, nsim = 5000, aic = TRUE, N = 2550)

```

##### b {#Wb}
```{r, echo=FALSE}
o_mw14g_source_note = paste("N = ", o_mw14g$N[1], "nests, AIC = ", round(as.numeric(o_mw14g$AIC[1], 4), 2), ", Marginal R-squared = ", round(as.numeric(o_mw14g$R2_mar[1], 4), 2), ", Conditional R-squared = ", round(as.numeric(o_mw14g$R2_con[1], 4), 2))

o_mw14g %>% 
  mutate(CI_String = ifelse(!is.na(lwr_r),
                     paste0("[", 
                     lwr_r, ", ", 
                     upr_r, "]"),
                     NA)) %>% 
  dplyr::select(type, effect, estimate_r, CI_String) %>% 
  gt(groupname_col = "type") %>% 
  cols_label(effect = "Effect type",
             estimate_r = "Parameter estimate",
             CI_String = "95% credible interval") %>% 
  cols_align(align = "left",
             columns = vars(effect)) %>% 
  tab_options(row_group.font.weight = "bold",
              row_group.background.color = "grey",
              table.font.size = 12,
              data_row.padding = 3,
              row_group.padding = 4,
              summary_row.padding = 2,
              column_labels.font.size = 14,
              column_labels.hidden = TRUE,
              row_group.font.size = 12,
              table.width = pct(80)) #%>% 
  # tab_source_note(source_note = o_mw14g_source_note)
```


```{r, results="hide", cache=TRUE, echo=FALSE}
mw0gs =  lmer(day_14_weight ~ 
  net_rearing_manipulation * chick_sex_molec + 
  brood_sex_ratio +
  (1|day14_measurer) + (1|rear_area) + 
  (1|rear_nest_OH_l) + (1|hatch_year)  +
  (1|rear_nest_breed_ID)+
  (1|hatch_mom_Ring) + (1|genetic_dad),
  data = dwg, REML = reml
  )
```

```{r, echo=FALSE, eval=FALSE}
summary(mw0gs) 
summary(glht(mw0gs))
```

```{r, echo=FALSE, eval=FALSE}
plot(allEffects(mw0gs))
```
```{r, echo=FALSE, results="hide", cache=TRUE}
o_mw0gs = m_out(name = "c - (a) with sex interaction", model = mw0gs, round_ = 3, nsim = 5000, aic = TRUE, N = 2550)   

```
##### c {#Wc}
```{r, echo=FALSE}
o_mw0gs_source_note = paste("N = ", o_mw0gs$N[1], "nests, AIC = ", 
                            round(as.numeric(o_mw0gs$AIC[1], 4), 2), 
                            ", Marginal R-squared = ", 
                            round(as.numeric(o_mw0gs$R2_mar[1], 4), 2), 
                            ", Conditional R-squared = ", 
                            round(as.numeric(o_mw0gs$R2_con[1], 4), 2))

o_mw0gs %>% 
  mutate(CI_String = ifelse(!is.na(lwr_r),
                     paste0("[", 
                     lwr_r, ", ", 
                     upr_r, "]"),
                     NA)) %>% 
  dplyr::select(type, effect, estimate_r, CI_String) %>% 
  gt(groupname_col = "type") %>% 
  cols_label(effect = "Effect type",
             estimate_r = "Parameter estimate",
             CI_String = "95% credible interval") %>% 
  cols_align(align = "left",
             columns = vars(effect)) %>% 
  tab_options(row_group.font.weight = "bold",
              row_group.background.color = "grey",
              table.font.size = 12,
              data_row.padding = 3,
              row_group.padding = 4,
              summary_row.padding = 2,
              column_labels.font.size = 14,
              column_labels.hidden = TRUE,
              row_group.font.size = 12,
              table.width = pct(80)) #%>% 
  # tab_source_note(source_note = o_mw0gs_source_note)
```

```{r, echo=FALSE, eval=FALSE}
            sname = 'Table_W'

            aic = data.table(rbind(o_mw0g,o_mw14g,o_mw0gs))[AIC!=""]
            aic[, AIC := as.numeric(AIC)]
            aic[, deltaAIC := AIC-min(AIC)]
            aic[, prob := round(exp(-0.5*deltaAIC)/sum(exp(-0.5*deltaAIC)),2)]
            aic[, ER := round(max(prob)/prob, 2)]
            aic[order(deltaAIC)]
            o = rbind(o_mw0g,o_mw14g,o_mw0gs)
            o$deltaAIC[o$AIC!=""] = aic$deltaAIC[match(o$model[o$AIC!=""], aic$model)]
            o$prob[o$AIC!=""] = aic$prob[match(o$model[o$AIC!=""], aic$model)]
            o$ER[o$AIC!=""] = aic$ER[match(o$model[o$AIC!=""], aic$model)]
            write.xlsx(o, paste0("Output/",sname,'.xlsx'), sheetName='Estimates&AIC')
            
            m_ass(name = 'Table Wa - weight-net+sex + day14_brood_sex_ratio', mo = mw0g, dat = dwg, fixed = c('net_rearing_manipulation', 'brood_sex_ratio'),categ = 'chick_sex_molec', trans = c('none','none','none'), spatial = FALSE, temporal = TRUE, PNG = TRUE, outdir = "Output/Model_ass/")
            
            m_ass(name = 'Table Wa - weight-net+sex + day14_brood_sex_ratio', mo = mw14g, dat = dwg, fixed = c('d14_rear_nest_brood_size', 'brood_sex_ratio'),categ = 'chick_sex_molec', trans = c('none','none','none'), spatial = FALSE, temporal = TRUE, PNG = TRUE, outdir = "Output/Model_ass/")

            m_ass(name = 'Table Wc - weight-netxsex + day14_brood_sex_ratio', mo = mw0gs, dat = dwg, fixed = c('net_rearing_manipulation', 'brood_sex_ratio'),categ = 'chick_sex_molec', trans = c('none','none','none'), spatial = FALSE, temporal = TRUE, PNG = TRUE, outdir = "Output/Model_ass/")
```

***

```{r, echo=FALSE}            
dmg = a[complete.cases(a),.(body_mass_index, net_rearing_manipulation, net_rearing_manipulation_factor, d14_rear_nest_brood_size, chick_sex_molec, brood_sex_ratio, day14_measurer, rear_area, rear_nest_OH_l, hatch_year,rear_nest_breed_ID, hatch_mom_Ring, genetic_dad)]
```

```{r, results="hide", cache=TRUE, echo=FALSE}
mb0g =  lmer(body_mass_index ~ 
    net_rearing_manipulation +  
    chick_sex_molec + 
    brood_sex_ratio +
    (1|day14_measurer) + (1|rear_area) + 
    (1|rear_nest_OH_l) + (1|hatch_year)  +
    (1|rear_nest_breed_ID) +
    (1|hatch_mom_Ring) + (1|genetic_dad),
    data = dmg, REML = reml
    )
```

```{r, echo=FALSE, eval=FALSE}
summary(mb0g) 
summary(glht(mb0g))
```

```{r, echo=FALSE, cache=TRUE, eval=FALSE}
plot(allEffects(mb0g))
```


```{r, echo=FALSE, results="hide", cache=TRUE}
o_mb0g = m_out(name = "a - net chick", model = mb0g, round_ = 5, nsim = 5000, aic = TRUE, N = 2550)
```

#### Table B | Effect sizes for chick body mass index models {#TableB}
##### a {#Ba}
```{r, echo=FALSE}
o_mb0g_source_note = paste("N = ", o_mb0g$N[1], "nests, AIC = ", round(as.numeric(o_mb0g$AIC[1], 4), 2), ", Marginal R-squared = ", round(as.numeric(o_mb0g$R2_mar[1], 4), 2), ", Conditional R-squared = ", round(as.numeric(o_mb0g$R2_con[1], 4), 2))

o_mb0g %>% 
  mutate(CI_String = ifelse(!is.na(lwr_r),
                     paste0("[", 
                     lwr_r, ", ", 
                     upr_r, "]"),
                     NA)) %>% 
  dplyr::select(type, effect, estimate_r, CI_String) %>% 
  gt(groupname_col = "type") %>% 
  cols_label(effect = "Effect type",
             estimate_r = "Parameter estimate",
             CI_String = "95% credible interval") %>% 
  cols_align(align = "left",
             columns = vars(effect)) %>% 
  tab_options(row_group.font.weight = "bold",
              row_group.background.color = "grey",
              table.font.size = 12,
              data_row.padding = 3,
              row_group.padding = 4,
              summary_row.padding = 2,
              column_labels.font.size = 14,
              row_group.font.size = 12,
              table.width = pct(80)) #%>% 
  # tab_source_note(source_note = o_mb0g_source_note)
```

```{r, results="hide", cache=TRUE, echo=FALSE}
mb14g =  lmer(body_mass_index ~ 
    d14_rear_nest_brood_size +  
    chick_sex_molec + 
    brood_sex_ratio +
    (1|day14_measurer) + (1|rear_area) + 
    (1|rear_nest_OH_l) + (1|hatch_year)  +
    (1|rear_nest_breed_ID)+
    (1|hatch_mom_Ring) + (1|genetic_dad),
    data = dmg, REML = reml
    )
```

```{r, echo=FALSE, eval=FALSE}
summary(mb14g) 
summary(glht(mb14g))
```

```{r, echo=FALSE, eval=FALSE}
plot(allEffects(mb14g))
```
```{r, echo=FALSE, results="hide", cache=TRUE}
o_mb14g  = m_out(name = "b - day 14 chick #", model = mb14g, round_ = 5, nsim = 5000, aic = TRUE, N = 2550)
```

##### b {#Bb}
```{r, echo=FALSE}
o_mb14g_source_note = paste("N = ", o_mb14g$N[1], "nests, AIC = ", round(as.numeric(o_mb14g$AIC[1], 4), 2), ", Marginal R-squared = ", round(as.numeric(o_mb14g$R2_mar[1], 4), 2), ", Conditional R-squared = ", round(as.numeric(o_mb14g$R2_con[1], 4), 2))

o_mb14g %>% 
  mutate(CI_String = ifelse(!is.na(lwr_r),
                     paste0("[", 
                     lwr_r, ", ", 
                     upr_r, "]"),
                     NA)) %>% 
  dplyr::select(type, effect, estimate_r, CI_String) %>% 
  gt(groupname_col = "type") %>% 
  cols_label(effect = "Effect type",
             estimate_r = "Parameter estimate",
             CI_String = "95% credible interval") %>% 
  cols_align(align = "left",
             columns = vars(effect)) %>% 
  tab_options(row_group.font.weight = "bold",
              row_group.background.color = "grey",
              table.font.size = 12,
              data_row.padding = 3,
              row_group.padding = 4,
              summary_row.padding = 2,
              column_labels.font.size = 14,
              column_labels.hidden = TRUE,
              row_group.font.size = 12,
              table.width = pct(80)) #%>% 
  # tab_source_note(source_note = o_mb14g_source_note)
```

```{r, results="hide", cache=TRUE, echo=FALSE}
mb0gs =  lmer(body_mass_index ~ 
    net_rearing_manipulation * chick_sex_molec + 
    brood_sex_ratio +
    (1|day14_measurer) + (1|rear_area) + 
    (1|rear_nest_OH_l) + (1|hatch_year)  +
    (1|rear_nest_breed_ID)+
    (1|hatch_mom_Ring) + (1|genetic_dad),
    data = dmg, REML = reml
    )
```

```{r, echo=FALSE, eval=FALSE}
summary(mb0gs) 
summary(glht(mb0gs))
```

```{r, echo=FALSE, eval=FALSE}
plot(allEffects(mb0gs))
```
```{r, echo=FALSE, results="hide", cache=TRUE}
o_mb0gs = m_out(name = "c - (a) with sex interaction", model = mb0gs, round_ = 5, nsim = 5000, aic = TRUE, N = 2550)   
```

##### c {#Bc}
```{r, echo=FALSE}
o_mb0gs_source_note = paste("N = ", o_mb0gs$N[1], "nests, AIC = ", 
                            round(as.numeric(o_mb0gs$AIC[1], 4), 2), 
                            ", Marginal R-squared = ", 
                            round(as.numeric(o_mb0gs$R2_mar[1], 4), 2), 
                            ", Conditional R-squared = ", 
                            round(as.numeric(o_mb0gs$R2_con[1], 4), 2))

o_mb0gs %>% 
  mutate(CI_String = ifelse(!is.na(lwr_r),
                     paste0("[", 
                     lwr_r, ", ", 
                     upr_r, "]"),
                     NA)) %>% 
  dplyr::select(type, effect, estimate_r, CI_String) %>% 
  gt(groupname_col = "type") %>% 
  cols_label(effect = "Effect type",
             estimate_r = "Parameter estimate",
             CI_String = "95% credible interval") %>% 
  cols_align(align = "left",
             columns = vars(effect)) %>% 
  tab_options(row_group.font.weight = "bold",
              row_group.background.color = "grey",
              table.font.size = 12,
              data_row.padding = 3,
              row_group.padding = 4,
              summary_row.padding = 2,
              column_labels.font.size = 14,
              column_labels.hidden = TRUE,
              row_group.font.size = 12,
              table.width = pct(80)) #%>% 
  # tab_source_note(source_note = o_mb0gs_source_note)
```

```{r, eval=FALSE, echo=FALSE}
            sname = 'Table_B'

            aic = data.table(rbind(o_mb0g,o_mb14g,o_mb0gs))[AIC!=""]
            aic[, AIC := as.numeric(AIC)]
            aic[, deltaAIC := AIC-min(AIC)]
            aic[, prob := round(exp(-0.5*deltaAIC)/sum(exp(-0.5*deltaAIC)),2)]
            aic[, ER := round(max(prob)/prob, 2)]
            aic[order(deltaAIC)]
            o = rbind(o_mb0g,o_mb14g,o_mb0gs)
            o$deltaAIC[o$AIC!=""] = aic$deltaAIC[match(o$model[o$AIC!=""], aic$model)]
            o$prob[o$AIC!=""] = aic$prob[match(o$model[o$AIC!=""], aic$model)]
            o$ER[o$AIC!=""] = aic$ER[match(o$model[o$AIC!=""], aic$model)]
            write.xlsx(o, paste0("Output/",sname,'.xlsx'), sheetName='Estimates&AIC')
            #write_xlsx(rbind(o_mb0g,o_mb14g,o_mb0g), paste0("Outputs/",sname,'.xlsx'), sheetName='AICcompar', append = TRUE)

            m_ass(name = 'Table Ba - BMI-net+sex + day14_brood_sex_ratio', mo = mb0g, dat = dmg, fixed = c('net_rearing_manipulation', 'brood_sex_ratio'),categ = 'chick_sex_molec', trans = c('none','none','none'), spatial = FALSE, temporal = TRUE, PNG = TRUE, outdir = "Output/Model_ass/")
            
            m_ass(name = 'Table Bb - BMI-d14+sex + day14_brood_sex_ratio', mo = mb14g, dat = dmg, fixed = c('d14_rear_nest_brood_size', 'brood_sex_ratio'),categ = 'chick_sex_molec', trans = c('none','none','none'), spatial = FALSE, temporal = TRUE, PNG = TRUE, outdir = "Output/Model_ass/")

            m_ass(name = 'Table Bc - BMI-netxsex + day14_brood_sex_ratio', mo = mb0gs, dat = dmg, fixed = c('net_rearing_manipulation', 'brood_sex_ratio'),categ = 'chick_sex_molec', trans = c('none','none','none'), spatial = FALSE, temporal = TRUE, PNG = TRUE, outdir = "Output/Model_ass/")
        # Table Be - Extended material
```

***
```{r Fig EP, echo=FALSE, fig.width=8, fig.height=8}
mortality_plot <-
  ggplot(data = morphometric_summaries) +
  geom_abline(intercept = 0 , slope = 1, linetype = "dashed", color = "grey30") + 
  # geom_point(aes(y = as.numeric(change_chick_n_increase), x = as.numeric(change_chick_n_decrease)), alpha = 0.5) +
  geom_jitter(aes(y = as.numeric(change_chick_n_increase), x = as.numeric(change_chick_n_decrease)), 
              alpha = 0.5, width = 0.1, height = 0.2) +
  coord_fixed(ratio = 1) +
  xlab(expression(paste("Number of dead chicks in ", italic("REDUCED")," brood (± SE)"))) +
  ylab(expression(paste("Number of dead chicks in ", italic("ENLARGED")," brood (± SE)"))) +
  scale_y_continuous(limits = c(-1, 10)) +
  scale_x_continuous(limits = c(-1, 10)) +
  annotate(geom = "text", y = 7.25, x = 8.5, angle = 45,
           label = "Brood reduction increased\nchick mortality",
           color = "black", size = 2.5, fontface = 'italic') +
  annotate(geom = "text", y = 8.5, x = 7.25, angle = 45,
           label = "Brood reduction decreased\nchick mortality",
           color = "black", size = 2.5, fontface = 'italic') +
  annotate(geom = "text", y = 10, x = -1,
           label = "M",
           color = "black", size = 6, fontface = 'bold') +
  theme_bw() +
  theme(
    #text = element_text(family = "Franklin Gothic Book"),
    legend.title = element_text(size = 10),
    legend.text = element_text(size = 8),
    axis.title.x = element_text(size = 10),
    axis.text.x  = element_text(size = 8), 
    axis.title.y = element_text(size = 10),
    axis.text.y = element_text(size = 8),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    axis.ticks = element_line(size = 0.5, colour = "grey40"),
    axis.ticks.length = unit(0.2, "cm"),
    panel.border = element_rect(linetype = "solid", colour = "grey")
  )

tarsus_plot <- 
  ggplot(data = morphometric_summaries) +
  geom_abline(intercept = 0 , slope = 1, linetype = "dashed", color = "grey30") + 
  geom_point(aes(y = mean_tarsus_increase, x = mean_tarsus_decrease), alpha = 0.5) +
  geom_errorbar(aes(y = mean_tarsus_increase, x = mean_tarsus_decrease, 
                    ymin = mean_tarsus_increase - se_tarsus_increase, 
                    ymax = mean_tarsus_increase + se_tarsus_increase), alpha = 0.2) +
  geom_errorbarh(aes(y = mean_tarsus_increase, x = mean_tarsus_decrease, 
                     xmin = mean_tarsus_decrease - se_tarsus_decrease, 
                     xmax = mean_tarsus_decrease + se_tarsus_decrease), alpha = 0.2) +
  coord_fixed(ratio = 1) +
  xlab(expression(paste("Mean tarsus length in ", italic("REDUCED")," brood (cm ± SE)"))) +
  ylab(expression(paste("Mean tarsus length in ", italic("ENLARGED")," brood (cm ± SE)"))) +
  scale_y_continuous(limits = c(13, 18)) +
  scale_x_continuous(limits = c(13, 18)) +
  annotate(geom = "text", y = 14, x = 14.5, angle = 45,
           label = "Brood reduction increased\naverage body size in brood",
           color = "black", size = 2.5, fontface = 'italic') +
  annotate(geom = "text", y = 14.5, x = 14, angle = 45,
           label = "Brood reduction decreased\naverage body size in brood",
           color = "black", size = 2.5, fontface = 'italic') +
  annotate(geom = "text", y = 18, x = 13,
           label = "T",
           color = "black", size = 6, fontface = 'bold') +
  theme_bw() +
  theme(
    #text = element_text(family = "Franklin Gothic Book"),
    legend.title = element_text(size = 10),
    legend.text = element_text(size = 8),
    axis.title.x = element_text(size = 10),
    axis.text.x  = element_text(size = 8), 
    axis.title.y = element_text(size = 10),
    axis.text.y = element_text(size = 8),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    axis.ticks = element_line(size = 0.5, colour = "grey40"),
    axis.ticks.length = unit(0.2, "cm"),
    panel.border = element_rect(linetype = "solid", colour = "grey")
  )

mass_plot <-
  ggplot(data = morphometric_summaries) +
  geom_abline(intercept = 0 , slope = 1, linetype = "dashed", color = "grey30") + 
  geom_point(aes(y = mean_mass_increase, x = mean_mass_decrease), alpha = 0.5) +
  geom_errorbar(aes(y = mean_mass_increase, x = mean_mass_decrease, 
                    ymin = mean_mass_increase - se_mass_increase, 
                    ymax = mean_mass_increase + se_mass_increase), alpha = 0.2) +
  geom_errorbarh(aes(y = mean_mass_increase, x = mean_mass_decrease, 
                     xmin = mean_mass_decrease - se_mass_decrease, 
                     xmax = mean_mass_decrease + se_mass_decrease), alpha = 0.2) +
  coord_fixed(ratio = 1) +
  xlab(expression(paste("Mean body weight in ", italic("REDUCED")," brood (g ± SE)"))) +
  ylab(expression(paste("Mean body weight in ", italic("ENLARGED")," brood (g ± SE)"))) +
  scale_y_continuous(limits = c(6, 13)) +
  scale_x_continuous(limits = c(6, 13)) +
  annotate(geom = "text", y = 13, x = 6,
           label = "W",
           color = "black", size = 6, fontface = 'bold') +
  theme_bw() +
  theme(
    #text = element_text(family = "Franklin Gothic Book"),
    legend.title = element_text(size = 10),
    legend.text = element_text(size = 8),
    axis.title.x = element_text(size = 10),
    axis.text.x  = element_text(size = 8), 
    axis.title.y = element_text(size = 10),
    axis.text.y = element_text(size = 8),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    axis.ticks = element_line(size = 0.5, colour = "grey40"),
    axis.ticks.length = unit(0.2, "cm"),
    panel.border = element_rect(linetype = "solid", colour = "grey")
  )

BMI_plot <-
  ggplot(data = morphometric_summaries) +
  geom_abline(intercept = 0 , slope = 1, linetype = "dashed", color = "grey30") + 
  geom_point(aes(y = mean_BMI_increase, x = mean_BMI_decrease), alpha = 0.5) +
  geom_errorbar(aes(y = mean_BMI_increase, x = mean_BMI_decrease, 
                    ymin = mean_BMI_increase - se_BMI_increase, 
                    ymax = mean_BMI_increase + se_BMI_increase), alpha = 0.2) +
  geom_errorbarh(aes(y = mean_BMI_increase, x = mean_BMI_decrease, 
                     xmin = mean_BMI_decrease - se_BMI_decrease, 
                     xmax = mean_BMI_decrease + se_BMI_decrease), alpha = 0.2) +
  coord_fixed(ratio = 1) +
  xlab(expression(paste("Mean body mass index in ", italic("REDUCED")," brood (± SE)"))) +
  ylab(expression(paste("Mean body mass index in ", italic("ENLARGED")," brood (± SE)"))) +
  scale_y_continuous(limits = c(0.025, 0.0475)) +
  scale_x_continuous(limits = c(0.025, 0.0475)) +
  annotate(geom = "text", y = 0.0475, x = 0.025,
           label = "B",
           color = "black", size = 6, fontface = 'bold') +
  theme_bw() + 
  theme(
   # text = element_text(family = "Franklin Gothic Book"),
    legend.title = element_text(size = 10),
    legend.text = element_text(size = 8),
    axis.title.x = element_text(size = 10),
    axis.text.x  = element_text(size = 8), 
    axis.title.y = element_text(size = 10),
    axis.text.y = element_text(size = 8),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    axis.ticks = element_line(size = 0.5, colour = "grey40"),
    axis.ticks.length = unit(0.2, "cm"),
    panel.border = element_rect(linetype = "solid", colour = "grey")
  )

ggarrange(mortality_plot,
          tarsus_plot,
          mass_plot,
          BMI_plot,
          ncol = 2, nrow = 2, align = "hv")
```

#### Figure EP | Differences in chick mortality and size within paired nests {#FigEP}
Each point is a mean, the bars are standars errors (horizontal for the reduced brood, vertical for the enlarged brood) for each pair of nests that were experimentally controlled (“matched”) for hatch date and (partly) for brood size (see [Methods](https://raw.githack.com/MartinBulla/many_analysts/MS/Methods.html)). Dashed diagonal line represents no change in chick body morphometrics in response to the experimental brood enlargement or reduction. Points on the lower-right space of the plot show brood pairs in which chicks in the reduced treatment were larger than the increased treatment counterparts. Conversely, points in the upper-left space show brood pairs in which chicks in the enlarged treatment were larger than the reduced counterparts.

***